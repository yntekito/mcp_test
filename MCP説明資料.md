# MCP (Model Context Protocol) 説明資料

## MCPとは

MCP（Model Context Protocol）は、AI言語モデルとデータソースやツールを接続するためのオープンスタンダードプロトコルです。Anthropic社によって開発され、AIアシスタントがより幅広い情報源にアクセスできるようにすることを目的としています。

## MCPが解決する問題：N対N接続の複雑さ

### 従来の課題：N対N接続の爆発的複雑さ

従来のAI統合では、各AIアプリケーションが各サービスと個別に接続する必要がありました。これにより、N個のAIアプリケーションとM個のサービスの間でN×M個の接続が必要になる「N対N問題」が発生していました。

#### 従来の接続パターン（N対N）
```
AIアプリケーション側           サービス側
┌─────────────────┐          ┌─────────────────┐
│   ChatGPT       │◄────────►│   Google Drive  │
│                 │◄────────►│   Slack         │
│                 │◄────────►│   Notion        │
│                 │◄────────►│   GitHub        │
└─────────────────┘          └─────────────────┘
┌─────────────────┐          
│   Claude        │◄────────►│   Google Drive  │
│                 │◄────────►│   Slack         │
│                 │◄────────►│   Notion        │
│                 │◄────────►│   GitHub        │
└─────────────────┘          └─────────────────┘
┌─────────────────┐          
│   Gemini        │◄────────►│   Google Drive  │
│                 │◄────────►│   Slack         │
│                 │◄────────►│   Notion        │
│                 │◄────────►│   GitHub        │
└─────────────────┘          └─────────────────┘
```

**問題点：**
- **開発コスト**: 各AIアプリケーションが各サービスに対して個別の統合コードを開発
- **保守コスト**: サービスのAPI変更時に全てのAIアプリケーションで修正が必要
- **重複実装**: 同じ機能を複数のAIアプリケーションで重複して実装
- **品質のばらつき**: 各統合の品質やセキュリティレベルが異なる

### MCPによる解決：1対N接続への変換

MCPは、この複雑な接続パターンを標準化されたプロトコルによって簡素化します。

#### MCPを使った接続パターン（1対N）
```
AIアプリケーション側    MCP層           サービス側
┌─────────────────┐   ┌─────────┐    ┌─────────────────┐
│   ChatGPT       │◄─►│   MCP   │◄──►│ Google Drive    │
└─────────────────┘   │ Server  │    │ MCP Server      │
┌─────────────────┐   │         │    └─────────────────┘
│   Claude        │◄─►│         │    ┌─────────────────┐
└─────────────────┘   │         │◄──►│ Slack           │
┌─────────────────┐   │         │    │ MCP Server      │
│   Gemini        │◄─►│         │    └─────────────────┘
└─────────────────┘   │         │    ┌─────────────────┐
┌─────────────────┐   │         │◄──►│ Notion          │
│   新しいAI      │◄─►│         │    │ MCP Server      │
└─────────────────┘   └─────────┘    └─────────────────┘
                                      ┌─────────────────┐
                                   ◄─►│ GitHub          │
                                      │ MCP Server      │
                                      └─────────────────┘
```

### MCPの利点：接続数の大幅削減

#### 接続数の比較
- **従来**: N個のAIアプリ × M個のサービス = **N×M個の接続**
- **MCP**: N個のAIアプリ + M個のサービス = **N+M個の接続**

#### 具体例：5つのAIアプリと10のサービス
- **従来**: 5 × 10 = **50個の接続**
- **MCP**: 5 + 10 = **15個の接続**

**削減効果：70%の接続数削減**

### 開発・保守コストの削減効果

#### 新しいAIアプリケーションの追加時
```
従来の場合：
新しいAIアプリ → 全10サービスとの個別統合が必要
開発工数：10サービス × 各統合工数

MCPの場合：
新しいAIアプリ → MCPクライアントの実装のみ
開発工数：1つのMCPクライアント実装のみ
```

#### 新しいサービスの追加時
```
従来の場合：
新しいサービス → 全5AIアプリでの個別統合が必要
開発工数：5AIアプリ × 各統合工数

MCPの場合：
新しいサービス → MCPサーバーの実装のみ
開発工数：1つのMCPサーバー実装のみ
```

#### API変更時の対応
```
従来の場合：
サービスAPI変更 → 全AIアプリで修正が必要
修正箇所：N個のAIアプリ × 該当統合部分

MCPの場合：
サービスAPI変更 → 該当MCPサーバーのみ修正
修正箇所：1つのMCPサーバーのみ
```

### エコシステムの拡張性

MCPにより、AIアプリケーションとサービスの両方が独立して発展できるエコシステムが構築されます：

```
拡張可能なエコシステム
┌─────────────────────────────────────────────────────────────┐
│                    MCP エコシステム                          │
│                                                             │
│  AIアプリケーション層     │     サービス層                    │
│  ┌─────────────────┐     │     ┌─────────────────┐          │
│  │ 既存のAIアプリ    │     │     │ 既存のサービス    │          │
│  │ ・ChatGPT       │     │     │ ・Google Drive  │          │
│  │ ・Claude        │     │     │ ・Slack         │          │
│  │ ・Gemini        │     │     │ ・Notion        │          │
│  └─────────────────┘     │     └─────────────────┘          │
│          ▲               │               ▲                  │
│          │               │               │                  │
│  ┌─────────────────┐     │     ┌─────────────────┐          │
│  │ 新しいAIアプリ    │     │     │ 新しいサービス    │          │
│  │ ・独自AI         │     │     │ ・新API         │          │
│  │ ・企業内AI       │     │     │ ・社内システム    │          │
│  │ ・特化型AI       │     │     │ ・IoTデバイス    │          │
│  └─────────────────┘     │     └─────────────────┘          │
│                          │                                  │
│      すべてMCPプロトコルで標準化されて接続                      │
└─────────────────────────────────────────────────────────────┘
```

## 主な特徴

### 1. 統一されたインターフェース
- AI言語モデルが様々なデータソースやツールに一貫した方法でアクセス可能
- 標準化されたプロトコルにより、異なるサービス間での互換性を確保

### 2. セキュアな接続
- 認証とアクセス制御機能を内蔵
- データの安全な送受信を保証

### 3. 拡張性
- 新しいデータソースやツールを簡単に追加可能
- サードパーティによる拡張をサポート

## アーキテクチャ

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   AI モデル     │◄──►│   MCP サーバー   │◄──►│  データソース    │
│  (Claude等)     │    │                 │    │  (DB, API等)   │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 構成要素

1. **MCPクライアント**: AI言語モデル側のインターフェース
2. **MCPサーバー**: データソースとモデルの間の仲介役
3. **リソース**: アクセス可能なデータやツール
4. **ツール**: モデルが実行できる機能

## 使用例

### データベースアクセス
```javascript
// SQLiteデータベースへの接続例
const server = new MCPServer({
  name: "sqlite-server",
  version: "1.0.0"
});

server.setRequestHandler(ListResourcesRequestSchema, async () => {
  return {
    resources: [
      {
        uri: "sqlite://database.db",
        name: "商品データベース",
        description: "商品情報を管理するデータベース"
      }
    ]
  };
});
```

### APIアクセス
```javascript
// REST APIへの接続例
server.setRequestHandler(CallToolRequestSchema, async (request) => {
  if (request.params.name === "fetch_weather") {
    const response = await fetch(`https://api.weather.com/v1/current?location=${request.params.arguments.location}`);
    return {
      content: [{
        type: "text",
        text: JSON.stringify(await response.json())
      }]
    };
  }
});
```

## 主な利点

### 開発者にとって
- **標準化**: 一度学習すれば、様々なデータソースに対応可能
- **再利用性**: 既存のMCPサーバーを他のプロジェクトで活用
- **保守性**: 統一されたインターフェースにより、メンテナンスが容易

### ユーザーにとって
- **一貫性**: 異なるデータソースに対して同じ方法でアクセス
- **安全性**: 認証とアクセス制御による安全なデータアクセス
- **拡張性**: 新しいツールやデータソースの追加が容易

## 実装例

### 基本的なMCPサーバーの実装

```typescript
import { Server } from "@modelcontextprotocol/sdk/server/index.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";

const server = new Server(
  {
    name: "example-server",
    version: "1.0.0",
  },
  {
    capabilities: {
      resources: {},
      tools: {},
    },
  }
);

// リソースの一覧を返す
server.setRequestHandler(ListResourcesRequestSchema, async () => {
  return {
    resources: [
      {
        uri: "file://example.txt",
        name: "Example File",
        description: "サンプルファイル",
        mimeType: "text/plain"
      }
    ]
  };
});

// ツールの一覧を返す
server.setRequestHandler(ListToolsRequestSchema, async () => {
  return {
    tools: [
      {
        name: "echo",
        description: "入力されたテキストをそのまま返す",
        inputSchema: {
          type: "object",
          properties: {
            text: {
              type: "string",
              description: "エコーするテキスト"
            }
          }
        }
      }
    ]
  };
});

// サーバーの起動
const transport = new StdioServerTransport();
await server.connect(transport);
```

## 対応アプリケーション

### 現在対応しているアプリケーション
- **Claude Desktop**: Anthropic社のデスクトップアプリケーション
- **Claude Code**: 開発者向けのコードエディタ統合
- **カスタムクライアント**: SDKを使用した独自実装

### 将来の拡張予定
- より多くのAIアシスタントでの対応
- エンタープライズ向け機能の強化
- パフォーマンス最適化

## 始め方

### 1. 環境セットアップ
```bash
npm install @modelcontextprotocol/sdk
```

### 2. 基本的なサーバーの作成
```typescript
import { Server } from "@modelcontextprotocol/sdk/server/index.js";
// サーバーの実装...
```

### 3. クライアントでの設定
Claude Desktopの設定ファイルに追加：
```json
{
  "mcpServers": {
    "my-server": {
      "command": "node",
      "args": ["path/to/server.js"]
    }
  }
}
```

## まとめ

MCPは、AI言語モデルとデータソースを効率的に接続するための重要なプロトコルです。標準化されたインターフェースにより、開発者はより簡単にAIアプリケーションを構築でき、ユーザーはより豊富な情報源にアクセスできるようになります。

今後、MCPの普及により、AIアシスタントがより多様なタスクに対応できるようになることが期待されます。